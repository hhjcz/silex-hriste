{% extends "bodylayout.twig" %}

{% block title %}silex-hriste{% endblock %}

{% block content %}

    {% if userLoggedIn == true %}
        <div class="row">
            <div class="small-12 columns">
                {% if not showAllMessages %}
                    <a href="/facebook?showAllMessages=1" class="button tiny success">Show all</a>
                {% endif %}
                {% if showAllMessages %}
                    <a href="/facebook?showAllMessages=0" class="button tiny success">Show unread</a>
                {% endif %}
                <span class="small-text"> thread: {{ messages.unread }} unread, {{ messages.unseen }} unseen </span>
            </div>
        </div>

        <div class="row">
            <div class="small-12 columns small-text">
                <ul class="no-bullet">
                    {% for thread in messages.threads %}
                        {% if thread.unread > 0 or showAllMessages %}
                            <hr>
                            <li>
                                <span class="label info">{{ thread.users }}: </span>
                                <span class="small-text"> unread: {{ thread.unread }}
                                    , unseen: {{ thread.unseen }}</span>
                                <ul class="no-bullet">
                                    {% for message in thread.messages %}
                                        {% if (message['unread'] or showAllMessages) %}
                                            <li>
                                                <span class="label secondary">{{ message.from }}:</span>
                                                <span class="small-text">{{ message.created_time }}:</span>

                                                <div class="message-text">{{ message.message | raw }}</div>
                                            </li>
                                        {% endif %}
                                    {% endfor %}
                                </ul>
                            </li>
                        {% endif %}
                    {% endfor %}
                </ul>
            </div>
        </div>

        <div class="row">
            <div class="small-12 columns">
                Logged in as: {{ fbUserName }}, id: {{ fbId }}
            </div>
        </div>
        <div class="row">
            <div class="small-12 columns">
                <a class="button tiny" href="{{ logoutUrl }}">Facebook logout</a>
            </div>
        </div>
    {% endif %}

    {% if userLoggedIn == false %}
        <div class="row">
            Facebook <a class="buuton small" href="{{ loginUrl }}">login</a>
        </div>
    {% endif %}
{% endblock %}
