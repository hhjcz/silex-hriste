{% extends "layout.html" %}

{% block title %}silex-hriste{% endblock %}

{% block content %}
{% if userLoggedIn == true %}
<div class="row">
    {% if not showAllMessages %}
    <span class="col-xs-6 text-left">
        <a href="/facebook?showAllMessages=1">Show all</a>
    </span>
    {% endif %}
    {% if showAllMessages %}
    <span class="col-xs-6 text-left">
        <a href="/facebook?showAllMessages=0">Show unread</a>
    </span>
    {% endif %}
    <span class="col-xs-6 text-right">
        <a class="text-left" href="/angular">Angular</a>
    </span>
</div>
<div class="row">
    Logged in as: {{ fbUserName }}, id: {{ fbId }}
</div>
<div class="row">
    Threads: total unread: {{ messages.unread }}, unseen: {{ messages.unseen }}
    <ul>
        {% for thread in messages.threads %}
        {% if thread.unread > 0 or showAllMessages %}
        <hr>
        <li>
            {{ thread.users }}: unread: {{ thread.unread}}, unseen: {{ thread.unseen }}
            <ul>
                {% for message in thread.messages %}
                {% if (message['unread'] or showAllMessages) %}
                <li>
                    {{ message.created_time }}: {{ message.from }}:
                    <div class="text-success">{{ message.message | raw }}</div>
                </li>
                {% endif %}
                {% endfor %}
            </ul>
        </li>
        {% endif %}
        {% endfor %}
    </ul>
</div>
<div class="row">
    Facebook <a href="{{ logoutUrl }}">logout</a>
</div>
{% endif %}
{% if userLoggedIn == false %}
<div class="row">
    Facebook <a href="{{ loginUrl }}">login</a>
</div>
{% endif %}
{% endblock %}
